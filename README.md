# idleGame.js

写一个游戏是很不容易的，哪怕是最简单的放置类游戏。

各种各样混乱的数值，单位，科技，解锁，成就等元素基本可以阻拦大部分的尝试者。

我们希望任何一个有趣的人都可以简单的制作一款有爱的放置类游戏。

将自己的巧思与身边的好友分享。












--------------------


以上都是胡扯，说点实际的：

这个库应当实现以下的功能：

1. 抽象常见放置类的元素为基本元素
2. 建立基础的数据运算函数
3. 基本的数据保存和导出功能
4. 捕获和响应事件的功能


这个库中定义了三种基本的元素：

1. 单位：拥有名称、数量、增加速度、增加速度比例、最大值、最小值、变更影响（增加/减少单位时对其他单位的影响）、运行影响（影响就是正常情况下对其他单位上的影响）
2. 资源：拥有名称、数量、最大值、最小值
2. 科技：拥有名称、状态、变更影响（增加/减少单位时对其他单位的影响）、运行影响（影响就是正常情况下对其他单位上的影响）
3. 成就：拥有名称、状态、触发条件、变更影响（增加/减少单位时对其他单位的影响）、运行影响（影响就是正常情况下对其他单位上的影响）

其中单位和资源可以自己发生数值变化，科技只能被事件触发，而成就则是根据一定的条件被触发。
单位和科技可以减少，成就不可逆。

单位的数据结构应该是这样的：

    "human":{
        "type":"unit",
        "name":"人类",
        "figure":0,
        "speed":1,
        "rate":0.1,
        "max":10,
        "min":0,
        "change":{
            "food":{"figure":-1}
            callback:function(){
                this["food"]["figure"] = this["food"]["figure"]-1
            }
        },
        "run":function(){
            this["food"]["figure"] = this["food"]["figure"]-1
            this["wood"]["figure"] = this["wood"]["figure"]-1
        }
    }

以上的数据结构表示 人类这个单位每秒钟产生0.1个（设计数值的时候应该分不同类型），最大值10个，最小值1个，每增加一个人类消耗一个食物，并且每秒会消耗一个食物。但同时产生一个木头。
对其他单位的影响包括figure（数量，加法），speed（速度，加法），rate（加成，乘法），max（最大值，加法），min（最小值，加法），change，run（直接替换）

资源的数据结构类似于：

    "food":{
        "type":"resource"
        "name":"食物",
        "figure":0,
        "speed":1,
        "rate":0.1,
        "max":10,
        "min":0
    }

资源没有变更影响。其速度和速度比例受单位的影响。

科技的数据结构类似于：

    "axe":{
        "type":"tech",
        "name":"斧子"，
        "check":true,
        "change":{
            "food":{"figure":-1}
        },
        "run":{
            "food":{"figure":-1},
            "wood":{"rate":0.5}
        }
    }

成就的数据结构类似于：

    "10axe":{
        "type":"achievement"
        "name":"10把斧子"，
        "check":true,
        "trigger":{
            "axe":{"figure":10}
        },
        "change":{
            "food":{"figure":-1}
        },
        "run":{
            "food":{"figure":-1},
            "wood":{"rate":0.5}
        }
    }
    
change 和 run中，除了基本的数值变化之外，还会运行一次其中的callback函数。    

数据层运行的流程如下：
    1. 循环判断一次成就，如果达到条件，触发。
    2. 根据单位和资源的speed，rate计算数值的变化。
    3. 根据当前的数值，判断单位，科技是否满足条件。
    3. 当触发单位，资源和科技的事件的时候，先运行其中change的指令，然后将其中的run更新到对应的单位中。
